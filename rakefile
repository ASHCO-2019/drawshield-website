task :build do
  Rake::Task[:jekyll].invoke
end

task :update do
  Rake::Task[:submit].invoke
  Rake::Task[:latest].invoke
  Rake::Task[:gallery].invoke
end

task :deploy do
  sh %{ rsync -rcv --exclude-from=.deployignore /var/www/test/ /var/www/html }
end

desc 'Jekyll Build'
task :jekyll do
  sh %{ bundle exec jekyll build -d /var/www/test }
end

desc 'Gallery & catalog Build'
task :gallery do
  Dir.chdir('tools') do
    sh %{ php mkgallery.php }
    sh %{ php mkcatalog.php }
  end
end

desc 'Catalog Images'
task :catalog do
  Dir.chdir('tools') do
    sh %{ php compile.php }
  end
end

desc 'submit Gallery Entries'
task :submit do
  Dir.chdir('tools') do
    sh %{ php publish.php }
  end  
end

desc 'Set lowest gallery entry'
task :latest do
  Dir.chdir('tools') do
    sh %{ php latest.php }
  end  
end
